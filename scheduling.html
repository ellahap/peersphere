<!DOCTYPE html>
<html lang="en">
<head>
    <title>Study Session Scheduling</title>
    <style>
        body {
            display: flex;
            font-family: Courier, monospace;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: auto;
            flex-direction: column;
        }
        .sidebar {
            width: 200px;
            padding: 20px;
            position: absolute;
            top: 10px;
            left: 20px;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 2px;
            margin-top: 300px;
        }
        .cell {
            width: 60px;
            height: 40px;
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .cell:hover {
            outline: 2px solid black;
        }
        .user-list {
            margin-top: 20px;
        }
        .user-item {
            cursor: pointer;
            margin: 5px 0;
        }
        .title {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 40px;
        }
        .availability {
            width: 200px;
            padding: 20px;
            position: absolute;
            top: 10px;
            right: 20px;
        }
        .availability h3 {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .info {
            margin-top: 20px;
            padding-left: 0;
        }
        .user-name {
            margin: 10px 0;
        }
        .error {
            color: red;
            font-size: 14px;
            margin-bottom: 10px;
            margin-top: 20px;
        }
        .people-heading {
            margin-top: 40px;
            font-size: 18px;
            font-weight: bold;
        }
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .input-group label {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .input-group button {
            align-self: flex-start;
            margin-top: 10px;
        }
        .sidebar h3 {
            white-space: nowrap;
            margin-bottom: 10px;
        }
    </style>    
</head>
<body>
    <div class="title">Study Session Scheduling</div>

    <div class="sidebar">
        <h3>Add Your Availability</h3>
        <div class="input-group">
            <label>Name: <input id="name" type="text"></label>
            <label>Color: <input id="color" type="color"></label>
            <button onclick="addUser()">Add</button>
        </div>
        
        <div id="colorError" class="error"></div>
        
        <h3 class="people-heading">People</h3>
        
        <div class="user-list" id="userList"></div>
    </div>

    <div class="grid" id="calendar">
        <div></div>
        <div>Mon</div> <div>Tue</div> <div>Wed</div> <div>Thu</div> <div>Fri</div> <div>Sat</div> <div>Sun</div>
        <script>
            for (let hour = 0; hour < 24; hour++) {
                const formattedHour = hour === 0 ? '12 AM' : hour < 12 ? `${hour} AM` : hour === 12 ? '12 PM' : `${hour - 12} PM`;
                document.write(`<div>${formattedHour}</div>`);
                for (let day = 0; day < 7; day++) {
                    document.write(`<div class="cell" data-day="${day}" data-hour="${hour}" onmouseover="showInfo(this)" onclick="markAvailability(this)"></div>`);
                }
            }
        </script>
    </div>

    <div class="availability">
        <h3>Availability</h3>
        <div class="info" id="info"></div>
    </div>

    <script>
        const users = [];
        let currentUser = null;

        function addUser() {
            const name = document.getElementById('name').value;
            const color = document.getElementById('color').value;
            const colorError = document.getElementById('colorError');
            
            const isColorTaken = users.some(user => user.color === color);
            if (isColorTaken) {
                colorError.textContent = 'This color is already taken. Please choose a different color.';
                return;
            } else {
                colorError.textContent = '';
            }

            if (name && color) {
                let user = users.find(u => u.name === name);
                if (user) {
                    user.color = color;
                } else {
                    user = { name, color };
                    users.push(user);
                }
                document.getElementById('name').value = '';
                currentUser = user;
                updateUserList();
            }
        }

        function updateUserList() {
            const userList = document.getElementById('userList');
            userList.innerHTML = '';
            users.forEach(user => {
                const div = document.createElement('div');
                div.className = 'user-item';
                div.textContent = user.name;
                div.style.color = user.color;
                div.onclick = () => {
                    currentUser = user;
                    document.getElementById('name').value = user.name;
                    document.getElementById('color').value = user.color;
                };
                userList.appendChild(div);
            });
        }

        function markAvailability(cell) {
            if (!currentUser) return alert('Add yourself or select a user first!');

            if (!cell.dataset.users) cell.dataset.users = '';

            if (!cell.dataset.users.includes(currentUser.name)) {
                cell.dataset.users += `${currentUser.name},`;
                cell.style.backgroundColor = currentUser.color;
            }
        }

        function showInfo(cell) {
            const info = document.getElementById('info');
            const users = cell.dataset.users ? cell.dataset.users.split(',').filter(Boolean) : [];

            info.innerHTML = '';
            users.forEach(user => {
                const userDiv = document.createElement('div');
                userDiv.className = 'user-name';
                userDiv.textContent = user;
                const userObject = users.find(u => u.name === user);
                userDiv.style.color = userObject ? userObject.color : '#000';
                info.appendChild(userDiv);
            });
        }
    </script>
</body>
</html>